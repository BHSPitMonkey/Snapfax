{"version":3,"sources":["JeelizResizer.js","JeelizThreejsHelper.js","Camera.js","Edit.js","Send.js","Login.js","Profile.js","App.js","serviceWorker.js","index.js"],"names":["JeelizResizer","_domCanvas","_whCanvasPx","_resizeAttemptsCounter","_overSamplingFactor","_isFullScreen","_timerFullScreen","_callbackResize","_cameraResolutions","_isInvFullscreenWH","compute_overlap","whA","whB","whLandscape","whPortrait","areaTotal","areaOverlap","Math","min","update_sizeCanvas","domRect","getBoundingClientRect","round","width","height","setAttribute","on_windowResize","clearTimeout","setTimeout","resize_fullScreen","resize_canvasToFullScreen","window","reverse","faceFilter","resize","that","is_portrait","e","size_canvas","options","document","getElementById","canvasId","isFullScreen","isInvWH","onResize","addEventListener","console","log","callback","bind","overSamplingFactor","isFlipY","domElement","CSS","CSStransform","style","transform","indexOf","add_CSStransform","allResolutions","slice","forEach","wh","sort","resA","resB","bestCameraResolution","idealWidth","idealHeight","resize_canvas","JeelizHelper","_threeRenderer","_threeScene","_maxFaces","_isMultiFaces","_threeVideoMesh","_gl","_glVideoTexture","_threeVideoTexture","_faceFilterCv","_glShpCopy","_isDetected","_settings","rotationOffsetX","pivotOffsetYZ","detectionThreshold","detectionHysteresis","tweakMoveYRotateY","isDebugPivotPoint","_threeCompositeObjects","_threePivotedObjects","_detect_callback","_isVideoTextureReady","_isSeparateThreejsCanvas","detect","detectState","threeCompositeObject","i","visible","ds","detected","init","spec","detectCallback","threejsCanvas","maxFacesDetected","videoTexture","GL","canvasElement","threejsCanvasId","THREE","context","canvas","alpha","frustumCulled","threeCompositeObjectPIVOTED","add","push","pivotCubeMesh","side","depthTest","position","copy","pivot","create_threeCompositeObjects","videoScreenVertexShaderSource","videoScreenFragmentShaderSource","compile_shader","source","type","typeString","shader","createShader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","alert","getShaderInfoLog","shader_vertex","VERTEX_SHADER","shader_fragment","FRAGMENT_SHADER","createProgram","attachShader","linkProgram","getUniformLocation","Uint8Array","needsUpdate","videoMaterial","depthWrite","vertexShader","fragmentShader","uniforms","samplerVideo","value","videoGeometry","videoScreenCorners","Float32Array","addAttribute","setIndex","Uint16Array","apply_videoTexture","renderOrder","create_videoScreen","returnedDict","videoMesh","renderer","scene","faceObjects","faceObject","get_isDetected","render","threeCamera","composer","halfTanFOV","tan","aspect","fov","PI","tweak","rx","cz","cos","rz","sz","sin","xTweak","s","yTweak","D","xv","x","yv","y","z","set","rotation","ry","update_positions3D","viewport","useProgram","activeTexture","TEXTURE0","bindTexture","TEXTURE_2D","drawElements","TRIANGLES","UNSIGNED_SHORT","state","reset","performance","now","sortFaces","bufferGeometry","axis","isInv","axisOffset","X","Y","Z","toUpperCase","sortWay","nFaces","index","count","faces","Array","array","aPos","attributes","centroids","map","face","faceIndex","ca","cb","centroid","centroidIndex","get_threeVideoTexture","threeMesh","onAfterRender","properties","update","magFilter","minFilter","create_threejsOccluder","occluderURL","occluderMesh","load","occluderGeometry","mat","basic","colorWrite","material","geometry","set_pivotOffsetYZ","pivotOffset","Camera","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","detect_callback","assertThisInitialized","onInitialResizeReady","onFaceFilterInitReady","initThreeScene","onTrack","onShutter","onCarouselChange","redirect","currentPhoto","sliderSettings","dots","infinite","speed","slidesToShow","slidesToScroll","centerMode","afterChange","effects","name","icon","bg","isDetected","threeStuffs","JeelizThreejsHelper","ctx","cubeGeometry","loader","setPath","texture","wrapS","wrapT","threeCube","aspecRatio","camera","EffectComposer","addPass","RenderPass","HueSaturationEffect","saturation","BrightnessContrastEffect","contrast","DotScreenEffect","scale","effectPass","isError","bestVideoSettings","NNCpath","callbackReady","callbackTrack","errCode","localStorage","setItem","toDataURL","location","hash","remove","brightness","dotAngle","VignetteEffect","PixelationEffect","GlitchEffect","glitchMode","GlitchMode","SPORADIC","pass","construct","EffectPass","concat","toConsumableArray","renderToScreen","removePass","react_default","a","createElement","react_router","to","className","id","backgroundImage","userImageUrl","backgroundSize","onClick","openProfile","onClickFlip","src","alt","lib_default","assign","effect","Camera_EffectThumb","key","React","Component","EffectThumb","backgroundColor","Edit","initialData","getItem","imageData","imageDataLoaded","onClickCancel","onClickSend","img","Image","onload","target","refs","getContext","drawImage","removeItem","setState","ref","Send","sending","loadingText","onSelect","updateLoader","_this2","confirm","audio","Audio","onended","play","fetch","method","body","JSON","stringify","image","then","response","data","Sending...","Sending","Sending.","Sending..","_this3","sendingElement","friendRows","photo","number","friend","idx","Send_DestinationRow","DestinationRow","Login","gapi","signin2","scope","longtitle","theme","Profile","react_router_dom","textAlign","fontSize","user","email","Profile_RowButton","label","href","RowButton","App","initSigninV2","onSigninChanged","onUserChanged","authState","auth2","client_id","isSignedIn","listen","currentUser","get","signIn","val","getId","profile","getBasicProfile","getName","getEmail","imageUrl","getImageUrl","userName","src_Login","src_Camera","exact","path","component","src_Profile","error","isLocalhost","Boolean","hostname","match","registerValidSW","swUrl","config","navigator","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","onUpdate","onSuccess","catch","ReactDOM","src_App_0","URL","process","origin","contentType","headers","status","ready","unregister","reload","checkValidServiceWorker"],"mappings":"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","file":"static/js/main.996a552e.chunk.js","sourcesContent":["import faceFilter from \"facefilter\";\n\nconst JeelizResizer = (function() {\n  //private vars :\n  var _domCanvas,\n    _whCanvasPx,\n    _resizeAttemptsCounter = 0,\n    _overSamplingFactor = 1,\n    _isFullScreen = false,\n    _timerFullScreen = false,\n    _callbackResize = false;\n  var _cameraResolutions = [\n    //all resolutions should be in landscape mode\n    [640, 480],\n    [768, 480],\n    [800, 600],\n    [960, 640],\n    [960, 720],\n    [1024, 768],\n    [1280, 720]\n  ];\n  var _isInvFullscreenWH = false;\n\n  //private functions\n  function add_CSStransform(domElement, CSS) {\n    var CSStransform = domElement.style.transform;\n    if (CSStransform.indexOf(CSS) !== -1) return;\n    domElement.style.transform = CSS + \" \" + CSStransform;\n  }\n\n  //compute overlap between 2 rectangles A and B\n  //characterized by their width and their height in pixels\n  //the rectangles are centered\n  //return the ratio (pixels overlaped)/(total pixels)\n  function compute_overlap(whA, whB) {\n    var aspectRatioA = whA[0] / whA[1],\n      aspectRatioB = whB[0] / whB[1]; //higher aspectRatio -> more landscape\n    var whLandscape, whPortrait;\n    if (aspectRatioA > aspectRatioB) {\n      whLandscape = whA;\n      whPortrait = whB;\n    } else {\n      whLandscape = whB;\n      whPortrait = whA;\n    }\n\n    //the overlapped area will be always a rectangle\n    var areaOverlap =\n      Math.min(whLandscape[0], whPortrait[0]) *\n      Math.min(whLandscape[1], whPortrait[1]);\n\n    var areaTotal;\n    if (whLandscape[0] >= whPortrait[0] && whLandscape[1] >= whPortrait[1]) {\n      //union is a rectangle\n      areaTotal = whLandscape[0] * whLandscape[1];\n    } else if (\n      whPortrait[0] > whLandscape[0] &&\n      whPortrait[1] > whLandscape[1]\n    ) {\n      //union is a rectangle\n      areaTotal = whPortrait[0] * whPortrait[1];\n    } else {\n      //union is a cross\n      areaTotal = whLandscape[0] * whLandscape[1];\n      areaTotal += (whPortrait[1] - whLandscape[1]) * whPortrait[0];\n    }\n\n    return areaOverlap / areaTotal;\n  } //end compute_overlap()\n\n  function update_sizeCanvas() {\n    var domRect = _domCanvas.getBoundingClientRect();\n    _whCanvasPx = [\n      Math.round(_overSamplingFactor * domRect.width),\n      Math.round(_overSamplingFactor * domRect.height)\n    ];\n    _domCanvas.setAttribute(\"width\", _whCanvasPx[0]);\n    _domCanvas.setAttribute(\"height\", _whCanvasPx[1]);\n  }\n\n  function on_windowResize() {\n    if (_timerFullScreen) {\n      clearTimeout(_timerFullScreen);\n    }\n    _timerFullScreen = setTimeout(resize_fullScreen, 50);\n  }\n\n  function resize_canvasToFullScreen() {\n    _whCanvasPx = [window[\"innerWidth\"], window[\"innerHeight\"]];\n    if (_isInvFullscreenWH) {\n      _whCanvasPx.reverse();\n    }\n    _domCanvas.setAttribute(\"width\", _whCanvasPx[0]);\n    _domCanvas.setAttribute(\"height\", _whCanvasPx[1]);\n  }\n\n  function resize_fullScreen() {\n    resize_canvasToFullScreen();\n    faceFilter.resize();\n    _timerFullScreen = false;\n    if (_callbackResize) {\n      _callbackResize();\n    }\n  }\n\n  //public methods :\n  var that = {\n    //return true or false if the device is in portrait or landscape mode\n    is_portrait: function() {\n      //https://stackoverflow.com/questions/4917664/detect-viewport-orientation-if-orientation-is-portrait-display-alert-message-ad\n      try {\n        if (window[\"matchMedia\"](\"(orientation: portrait)\")[\"matches\"]) {\n          return true;\n        } else {\n          return false;\n        }\n      } catch (e) {\n        return window[\"innerHeight\"] > window[\"innerWidth\"];\n      }\n    },\n\n    //size canvas to the right resolution\n    //should be called after the page loading\n    //when the canvas has already the right size\n    //options:\n    // - <string> canvasId: id of the canvas\n    // - <function> callback: function to launch if there was an error or not\n    // - <float> overSamplingFactor: facultative. If 1, same resolution than displayed size (default).\n    //   If 2, resolution twice higher than real size\n    // - <boolean> isFlipY: if we should flip the canvas or not. Default: false\n    // - <boolean> isFullScreen: if we should set the canvas fullscreen. Default : false\n    // - <function> onResize: function called when the window is resized. Only enabled if isFullScreen=true\n    // - <boolean> isInvWH: if we should invert width and height for fullscreen mode only. default=false\n    size_canvas: function(options) {\n      _domCanvas = document.getElementById(options.canvasId);\n      _isFullScreen =\n        typeof options.isFullScreen !== \"undefined\" && options.isFullScreen;\n      _isInvFullscreenWH =\n        typeof options.isInvWH !== \"undefined\" && options.isInvWH;\n\n      if (_isFullScreen) {\n        //we are in fullscreen mode\n        if (typeof options.onResize !== \"undefined\") {\n          _callbackResize = options.onResize;\n        }\n        resize_canvasToFullScreen();\n        window.addEventListener(\"resize\", on_windowResize, false);\n      } else {\n        //not fullscreen mode\n\n        //get display size of the canvas\n        var domRect = _domCanvas.getBoundingClientRect();\n        if (domRect.width === 0 || domRect.height === 0) {\n          console.log(\n            \"WARNING in JeelizResize.size_canvas() : the canvas has its width or its height null, Retry a bit later...\"\n          );\n          if (++_resizeAttemptsCounter > 20) {\n            options.callback(\"CANNOT_RESIZECANVAS\");\n            return;\n          }\n          setTimeout(that.size_canvas.bind(null, options), 50);\n          return;\n        }\n\n        //do resize canvas :\n        _resizeAttemptsCounter = 0;\n        _overSamplingFactor =\n          typeof options.overSamplingFactor === \"undefined\"\n            ? 1\n            : options.overSamplingFactor;\n        update_sizeCanvas();\n      }\n\n      //flip horizontally if required :\n      if (typeof options.isFlipY !== \"undefined\" && options.isFlipY) {\n        add_CSStransform(_domCanvas, \"rotateY(180deg)\");\n      }\n\n      //compute the best camera resolutions :\n      var allResolutions = _cameraResolutions.slice(0);\n\n      //if we are in portrait mode, the camera is also in portrait mode\n      //so we need to set all resolutions to portrait mode\n      if (that.is_portrait()) {\n        allResolutions.forEach(function(wh) {\n          wh.reverse();\n        });\n      }\n\n      //sort camera resolutions from the best to the worst :\n      allResolutions.sort(function(resA, resB) {\n        return (\n          compute_overlap(resB, _whCanvasPx) -\n          compute_overlap(resA, _whCanvasPx)\n        );\n      });\n\n      //pick the best camera resolution\n      var bestCameraResolution = {\n        idealWidth: allResolutions[0][0],\n        idealHeight: allResolutions[0][1]\n      };\n\n      //launch the callback function after a small interval to let it\n      //some time to size\n      setTimeout(options.callback.bind(null, false, bestCameraResolution), 1);\n    }, //end size_canvas()\n\n    resize_canvas: function() {\n      //should be called if the canvas is resized to update the canvas resolution\n      if (_isFullScreen) {\n        return;\n      }\n      update_sizeCanvas();\n    }\n  }; //end that\n  return that;\n})();\n\nexport default JeelizResizer;\n","import * as THREE from \"three\";\n\n/*\n  Helper for Three.js\n*/ \nconst JeelizHelper=(function(){\n  //internal settings\n  const _settings={\n    rotationOffsetX: 0, //negative -> look upper. in radians\n    pivotOffsetYZ: [0.4,0.2], //[0.2,0.2], //XYZ of the distance between the center of the cube and the pivot. enable _settings.isDebugPivotPoint to set this value\n    \n    detectionThreshold: 0.75, //sensibility, between 0 and 1. Less -> more sensitive\n    detectionHysteresis: 0.05,\n\n    tweakMoveYRotateY: 0.5, //tweak value: move detection window along Y axis when rotate the face\n    \n    isDebugPivotPoint: false //display a small cube for the pivot point\n  };\n\n  //private vars :\n  var _threeRenderer, _threeScene, _maxFaces, _isMultiFaces, _threeCompositeObjects=[], _threePivotedObjects=[], _detect_callback=null,\n    _threeVideoMesh, _gl, _glVideoTexture, _threeVideoTexture, _isVideoTextureReady=false, _isSeparateThreejsCanvas=false, _faceFilterCv, _glShpCopy, _isDetected;\n\n  //private funcs :\n  function create_threeCompositeObjects(){\n    for (let i=0; i<_maxFaces; ++i){\n      //COMPOSITE OBJECT WHICH WILL FOLLOW A DETECTED FACE\n      //in fact we create 2 objects to be able to shift the pivot point\n      const threeCompositeObject=new THREE.Object3D();\n      threeCompositeObject.frustumCulled=false;\n      threeCompositeObject.visible=false;\n\n      const threeCompositeObjectPIVOTED=new THREE.Object3D(); \n      threeCompositeObjectPIVOTED.frustumCulled=false;\n      //threeCompositeObjectPIVOTED.position.set(0, -_settings.pivotOffsetYZ[0], -_settings.pivotOffsetYZ[1]);\n      threeCompositeObject.add(threeCompositeObjectPIVOTED);\n\n      _threeCompositeObjects.push(threeCompositeObject);\n      _threePivotedObjects.push(threeCompositeObjectPIVOTED);\n      _threeScene.add(threeCompositeObject);\n\n      if (_settings.isDebugPivotPoint){\n        const pivotCubeMesh=new THREE.Mesh(new THREE.BoxGeometry(0.1,0.1,0.1), new THREE.MeshNormalMaterial({\n          side: THREE.DoubleSide,\n          depthTest: false\n        }));\n        pivotCubeMesh.position.copy(threeCompositeObjectPIVOTED.position);\n        threeCompositeObject.add(pivotCubeMesh);\n        window.pivot=pivotCubeMesh;\n        console.log('DEBUG in JeelizHelper: set the position of <pivot> in the console and report the value into JeelizThreejsHelper.js for _settings.pivotOffsetYZ');\n      }\n    }\n  }\n\n  function create_videoScreen(){\n    const videoScreenVertexShaderSource = \"attribute vec2 position;\\n\\\n        varying vec2 vUV;\\n\\\n        void main(void){\\n\\\n          gl_Position=vec4(position, 0., 1.);\\n\\\n          vUV=0.5+0.5*position;\\n\\\n        }\";\n    const videoScreenFragmentShaderSource = \"precision lowp float;\\n\\\n        uniform sampler2D samplerVideo;\\n\\\n        varying vec2 vUV;\\n\\\n        void main(void){\\n\\\n          gl_FragColor=texture2D(samplerVideo, vUV);\\n\\\n        }\";\n\n    if (_isSeparateThreejsCanvas){\n      const compile_shader=function(source, type, typeString) {\n        const shader = _gl.createShader(type);\n        _gl.shaderSource(shader, source);\n        _gl.compileShader(shader);\n        if (!_gl.getShaderParameter(shader, _gl.COMPILE_STATUS)) {\n          alert(\"ERROR IN \"+typeString+ \" SHADER : \" + _gl.getShaderInfoLog(shader));\n          return false;\n        }\n        return shader;\n      };\n\n      const shader_vertex=compile_shader(videoScreenVertexShaderSource, _gl.VERTEX_SHADER, 'VERTEX');\n      const shader_fragment=compile_shader(videoScreenFragmentShaderSource, _gl.FRAGMENT_SHADER, 'FRAGMENT');\n\n      _glShpCopy=_gl.createProgram();\n      _gl.attachShader(_glShpCopy, shader_vertex);\n      _gl.attachShader(_glShpCopy, shader_fragment);\n\n      _gl.linkProgram(_glShpCopy);\n      const samplerVideo=_gl.getUniformLocation(_glShpCopy, 'samplerVideo');\n \n      return;\n    }\n\n    //init video texture with red\n    _threeVideoTexture = new THREE.DataTexture( new Uint8Array([255,0,0]), 1, 1, THREE.RGBFormat);\n    _threeVideoTexture.needsUpdate=true;\n\n    //CREATE THE VIDEO BACKGROUND\n    const videoMaterial = new THREE.RawShaderMaterial({\n      depthWrite: false,\n      depthTest: false,\n      vertexShader: videoScreenVertexShaderSource,\n      fragmentShader: videoScreenFragmentShaderSource,\n       uniforms:{\n        samplerVideo: {value: _threeVideoTexture}\n       }\n    });\n    const videoGeometry = new THREE.BufferGeometry()\n    const videoScreenCorners = new Float32Array([-1,-1,   1,-1,   1,1,   -1,1]);\n    videoGeometry.addAttribute( 'position', new THREE.BufferAttribute( videoScreenCorners, 2 ) );\n    videoGeometry.setIndex(new THREE.BufferAttribute(new Uint16Array([0,1,2, 0,2,3]), 1));\n    _threeVideoMesh = new THREE.Mesh(videoGeometry, videoMaterial);\n    that.apply_videoTexture(_threeVideoMesh);\n    _threeVideoMesh.renderOrder=-1000; //render first\n    _threeVideoMesh.frustumCulled=false;\n    _threeScene.add(_threeVideoMesh);\n  } //end create_videoScreen()\n\n  function detect(detectState){\n    _threeCompositeObjects.forEach(function(threeCompositeObject, i){\n      _isDetected=threeCompositeObject.visible;\n      const ds=detectState[i];\n      if (_isDetected && ds.detected<_settings.detectionThreshold-_settings.detectionHysteresis){\n          //DETECTION LOST\n        if (_detect_callback) _detect_callback(i, false);\n        threeCompositeObject.visible=false;\n      } else if (!_isDetected && ds.detected>_settings.detectionThreshold+_settings.detectionHysteresis){\n        //FACE DETECTED\n        if (_detect_callback) _detect_callback(i, true);\n        threeCompositeObject.visible=true;\n      }\n    }); //end loop on all detection slots\n  }\n\n  function update_positions3D(ds, threeCamera){\n    const halfTanFOV=Math.tan(threeCamera.aspect*threeCamera.fov*Math.PI/360); //tan(<horizontal FoV>/2), in radians (threeCamera.fov is vertical FoV)\n         \n    _threeCompositeObjects.forEach(function(threeCompositeObject, i){\n      if (!threeCompositeObject.visible) return;\n      const detectState=ds[i];\n\n      //tweak Y position depending on rx (see)\n      const tweak=_settings.tweakMoveYRotateY*Math.tan(detectState.rx);\n      const cz=Math.cos(detectState.rz), sz=Math.sin(detectState.rz);\n      \n      const xTweak=sz*tweak*detectState.s;\n      const yTweak=cz*tweak*(detectState.s/threeCamera.aspect);\n\n      //move the cube in order to fit the head\n      const W=detectState.s;    //relative width of the detection window (1-> whole width of the detection window)\n      const D=1/(2*W*halfTanFOV); //distance between the front face of the cube and the camera\n      \n      //coords in 2D of the center of the detection window in the viewport :\n      const xv=detectState.x+xTweak;\n      const yv=detectState.y+yTweak;\n      \n      //coords in 3D of the center of the cube (in the view coordinates system)\n      const z=-D-0.5;   // minus because view coordinate system Z goes backward. -0.5 because z is the coord of the center of the cube (not the front face)\n      const x=xv*D*halfTanFOV;\n      const y=yv*D*halfTanFOV/threeCamera.aspect;\n\n      //the pivot position depends on rz rotation\n      _threePivotedObjects[i].position.set(-sz*_settings.pivotOffsetYZ[0],-cz*_settings.pivotOffsetYZ[0], -_settings.pivotOffsetYZ[1]);\n\n      //move and rotate the cube\n      threeCompositeObject.position.set(x,y+_settings.pivotOffsetYZ[0],z+_settings.pivotOffsetYZ[1]);\n      threeCompositeObject.rotation.set(detectState.rx+_settings.rotationOffsetX, detectState.ry, detectState.rz, \"ZXY\");\n    }); //end loop on composite objects\n  }\n\n  //public methods :\n  var that={\n    init: function(spec, detectCallback){ //launched with the same spec object than callbackReady. set spec.threejsCanvasId to the ID of the threejsCanvas to be in 2 canvas mode\n      _maxFaces=spec.maxFacesDetected;\n      _glVideoTexture=spec.videoTexture;\n      _gl=spec.GL;\n      _faceFilterCv=spec.canvasElement;\n      _isMultiFaces=(_maxFaces>1);\n\n      //enable 2 canvas mode if necessary\n      var threejsCanvas;\n      if (spec.threejsCanvasId){\n        _isSeparateThreejsCanvas=true;\n        //set the threejs canvas size to the threejs canvas\n        threejsCanvas=document.getElementById(spec.threejsCanvasId);\n        threejsCanvas.setAttribute('width', _faceFilterCv.width);\n        threejsCanvas.setAttribute('height', _faceFilterCv.height);\n      } else {\n        threejsCanvas=_faceFilterCv;\n      }\n\n      if (typeof(detectCallback)!=='undefined'){\n        _detect_callback=detectCallback;\n      }\n\n       //INIT THE THREE.JS context\n      _threeRenderer=new THREE.WebGLRenderer({\n        context: (_isSeparateThreejsCanvas)?null:_gl,\n        canvas: threejsCanvas,\n        alpha: (_isSeparateThreejsCanvas || spec.alpha)?true:false\n      });\n\n      _threeScene=new THREE.Scene();\n\n      create_threeCompositeObjects();\n      create_videoScreen();\n      \n      const returnedDict = {\n        videoMesh: _threeVideoMesh,\n        renderer: _threeRenderer,\n        scene: _threeScene\n      };\n      if (_isMultiFaces){\n        returnedDict.faceObjects=_threePivotedObjects;\n      } else {\n        returnedDict.faceObject=_threePivotedObjects[0];\n      }\n      return returnedDict;\n    }, //end that.init()\n\n    detect: function(detectState){\n      const ds=(_isMultiFaces)?detectState:[detectState];\n\n      //update detection states\n      detect(ds);\n    },\n\n    get_isDetected: function() {\n      return _isDetected;\n    },\n\n    render: function(detectState, threeCamera, composer){\n      const ds=(_isMultiFaces)?detectState:[detectState];\n\n      //update detection states\n      detect(ds);\n      update_positions3D(ds, threeCamera);\n\n      if (_isSeparateThreejsCanvas){\n        //render the video texture on the faceFilter canvas :\n        _gl.viewport(0,0, _faceFilterCv.width, _faceFilterCv.height);\n        _gl.useProgram(_glShpCopy);\n        _gl.activeTexture(_gl.TEXTURE0);\n        _gl.bindTexture(_gl.TEXTURE_2D, _glVideoTexture);\n        _gl.drawElements(_gl.TRIANGLES, 3, _gl.UNSIGNED_SHORT, 0);\n      } else {\n        //reinitialize the state of THREE.JS because JEEFACEFILTER have changed stuffs\n        // -> can be VERY costly !\n        _threeRenderer.state.reset();\n      }\n\n      //trigger the render of the THREE.JS SCENE\n      composer.render(performance.now());\n    },\n\n    sortFaces: function(bufferGeometry, axis, isInv){ //sort faces long an axis\n      //useful when a bufferGeometry has alpha : we should render the last faces first\n      const axisOffset={X:0, Y:1, Z:2}[axis.toUpperCase()];\n      const sortWay=(isInv)?-1:1;\n\n      //fill the faces array\n      const nFaces=bufferGeometry.index.count/3;\n      const faces=new Array(nFaces);\n      for (let i=0; i<nFaces; ++i){\n        faces[i]=[bufferGeometry.index.array[3*i], bufferGeometry.index.array[3*i+1], bufferGeometry.index.array[3*i+2]];\n      }\n\n      //compute centroids :\n      const aPos=bufferGeometry.attributes.position.array;\n      const centroids=faces.map(function(face, faceIndex){\n        return [\n          (aPos[3*face[0]]+aPos[3*face[1]]+aPos[3*face[2]])/3, //X\n          (aPos[3*face[0]+1]+aPos[3*face[1]+1]+aPos[3*face[2]+1])/3, //Y\n          (aPos[3*face[0]+2]+aPos[3*face[1]+2]+aPos[3*face[2]+2])/3, //Z\n          face\n        ];\n      });\n\n      //sort centroids\n      centroids.sort(function(ca, cb){\n        return (ca[axisOffset]-cb[axisOffset])*sortWay;\n      });\n\n      //reorder bufferGeometry faces :\n      centroids.forEach(function(centroid, centroidIndex){\n        const face=centroid[3];\n        bufferGeometry.index.array[3*centroidIndex]=face[0];\n        bufferGeometry.index.array[3*centroidIndex+1]=face[1];\n        bufferGeometry.index.array[3*centroidIndex+2]=face[2];\n      });\n    }, //end sortFaces\n\n    get_threeVideoTexture: function(){\n      return _threeVideoTexture;\n    },\n\n    apply_videoTexture: function(threeMesh){\n      if (_isVideoTextureReady){\n        return;\n      }\n      threeMesh.onAfterRender=function(){\n        //replace _threeVideoTexture.__webglTexture by the real video texture\n        try {\n          _threeRenderer.properties.update(_threeVideoTexture, '__webglTexture', _glVideoTexture);\n          _threeVideoTexture.magFilter=THREE.LinearFilter;\n          _threeVideoTexture.minFilter=THREE.LinearFilter;\n          _isVideoTextureReady=true;\n        } catch(e){\n          console.log('WARNING in THREE.JeelizHelper : the glVideoTexture is not fully initialized');\n        }\n        delete(threeMesh.onAfterRender);\n      };\n    },\n\n    //create an occluder, IE a transparent object which writes on the depth buffer\n    create_threejsOccluder: function(occluderURL, callback){\n      const occluderMesh=new THREE.Mesh();\n      new THREE.BufferGeometryLoader().load(occluderURL, function(occluderGeometry){\n        const mat=new THREE.ShaderMaterial({\n          vertexShader: THREE.ShaderLib.basic.vertexShader,\n          fragmentShader: \"precision lowp float;\\n void main(void){\\n gl_FragColor=vec4(1.,0.,0.,1.);\\n }\",\n          uniforms: THREE.ShaderLib.basic.uniforms,\n          colorWrite: false\n        });\n        //occluderGeometry.computeVertexNormals(); mat=new THREE.MeshNormalMaterial({side: THREE.DoubleSide});\n        occluderMesh.renderOrder=-1; //render first\n        occluderMesh.material=mat;\n        occluderMesh.geometry=occluderGeometry;\n        if (typeof(callback)!=='undefined' && callback) callback(occluderMesh);\n      });\n      return occluderMesh;\n    },\n    set_pivotOffsetYZ(pivotOffset) {\n      _settings.pivotOffsetYZ = pivotOffset;\n    }\n  }\n  return that;\n})();\n\nexport default JeelizHelper;\n","import React from \"react\";\nimport * as THREE from \"three\";\nimport faceFilter from \"facefilter\";\nimport JeelizResizer from \"./JeelizResizer\";\nimport JeelizThreejsHelper from \"./JeelizThreejsHelper\";\nimport { Redirect } from \"react-router\";\nimport {\n  DotScreenEffect,\n  EffectComposer,\n  HueSaturationEffect,\n  EffectPass,\n  RenderPass,\n  BrightnessContrastEffect,\n  VignetteEffect,\n  PixelationEffect,\n  GlitchEffect,\n  GlitchMode\n} from \"postprocessing\";\nimport Slider from \"react-slick\";\nimport \"./App.css\";\nimport { Vector2 } from \"three\";\n\nclass Camera extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.detect_callback = this.detect_callback.bind(this);\n    this.onInitialResizeReady = this.onInitialResizeReady.bind(this);\n    this.onFaceFilterInitReady = this.onFaceFilterInitReady.bind(this);\n    this.initThreeScene = this.initThreeScene.bind(this);\n    this.onTrack = this.onTrack.bind(this);\n    this.onShutter = this.onShutter.bind(this);\n    this.onCarouselChange = this.onCarouselChange.bind(this);\n\n    this.state = {\n      redirect: null,\n      currentPhoto: null\n    };\n\n    this.sliderSettings = {\n      dots: false,\n      infinite: true,\n      speed: 500,\n      slidesToShow: 3,\n      slidesToScroll: 1,\n      centerMode: true,\n      afterChange: this.onCarouselChange\n    };\n\n    this.effects = [\n      {\n        name: \"Default\",\n        icon: \"\"\n      },\n      {\n        name: \"1\",\n        bg: \"rgba(255, 255, 255, 0.5)\",\n        icon: \"/img/lightbulb.svg\"\n      },\n      {\n        name: \"2\",\n        bg: \"rgba(0, 0, 0, 0.5)\",\n        icon: \"/img/halftone.svg\"\n      },\n      {\n        name: \"3\",\n        bg: \"rgba(255, 255, 255, 0.5)\",\n        icon: \"/img/boxy.svg\"\n      },\n      {\n        name: \"4\",\n        bg: \"rgba(0, 0, 0, 0.5)\",\n        icon: \"/img/vignette.svg\"\n      },\n      {\n        name: \"5\",\n        bg: \"rgba(255, 255, 255, 0.5)\",\n        icon: \"/img/pixel.png\"\n      },\n      {\n        name: \"6\",\n        bg: \"rgba(255, 255, 255, 0.5)\",\n        icon: \"/img/glitch.png\"\n      },\n    //   {\n    //     name: \"7\",\n    //     bg: \"rgba(255, 255, 255, 0.5)\",\n    //     icon: \"/stories.svg\"\n    //   }\n    ];\n  }\n\n  detect_callback(faceIndex, isDetected) {\n    if (isDetected) {\n      console.log(\"INFO in detect_callback() : DETECTED\");\n    } else {\n      console.log(\"INFO in detect_callback() : LOST\");\n    }\n  }\n\n  initThreeScene(spec) {\n    const threeStuffs = JeelizThreejsHelper.init(spec, this.detect_callback);\n    const { scene, renderer, faceObject } = threeStuffs;\n    this.faceObject = faceObject;\n    this.ctx = spec.GL;\n\n    // CREATE A CUBE\n    const cubeGeometry = new THREE.BoxGeometry(1, 1, 1);\n\n    var loader = new THREE.TextureLoader();\n    loader.setPath(\"/\");\n    var texture = loader.load(\"./icon512.png\");\n    texture.wrapS = THREE.RepeatWrapping;\n    texture.wrapT = THREE.RepeatWrapping;\n    const material = new THREE.MeshBasicMaterial({\n      map: texture\n    });\n    this.threeCube = new THREE.Mesh(cubeGeometry, material);\n    this.threeCube.frustumCulled = false;\n    //threeStuffs.faceObject.add(threeCube);\n\n    //CREATE THE CAMERA\n    var aspecRatio = spec.canvasElement.width / spec.canvasElement.height;\n    this.camera = new THREE.PerspectiveCamera(20, aspecRatio, 0.1, 100);\n\n    // Prepare postprocessing\n    this.composer = new EffectComposer(renderer);\n    this.composer.addPass(new RenderPass(scene, this.camera));\n\n    // Create effects\n    const saturationEffect = new HueSaturationEffect({ saturation: -1 });\n    const brightnessContrastEffect = new BrightnessContrastEffect({\n      contrast: 0.5\n    });\n    const dotScreenEffect = new DotScreenEffect({ scale: 2 });\n\n    // Add the effects\n    this.effectPass = null;\n    this.onCarouselChange(0);\n    // this.effectPass = new EffectPass(\n    //   this.camera,\n    //   saturationEffect,\n    //   brightnessContrastEffect,\n    //   dotScreenEffect\n    // );\n    // this.effectPass.renderToScreen = true;\n    // this.composer.addPass(this.effectPass);\n  }\n\n  onInitialResizeReady(isError, bestVideoSettings) {\n    //init_faceFilter(bestVideoSettings);\n    console.log(\"best\", bestVideoSettings);\n    console.log(\"About to init\");\n    console.log(faceFilter);\n    faceFilter.init({\n      //you can also provide the canvas directly\n      //using the canvas property instead of canvasId:\n      canvasId: \"jeeFaceFilterCanvas\",\n      NNCpath: \"NNC.json\", //path to JSON neural network model (NNC.json by default)\n      callbackReady: this.onFaceFilterInitReady, //end callbackReady()\n\n      //called at each render iteration (drawing loop)\n      callbackTrack: this.onTrack\n    }); //end init call\n  }\n\n  onFaceFilterInitReady(errCode, spec) {\n    if (errCode) {\n      console.log(\"AN ERROR HAPPENS. ERROR CODE =\", errCode);\n      return;\n    }\n\n    console.log(\"INFO: JEEFACEFILTERAPI IS READY\");\n    this.initThreeScene(spec);\n  }\n\n  onTrack(detectState) {\n    JeelizThreejsHelper.render(detectState, this.camera, this.composer);\n  }\n\n  componentDidMount() {\n    console.log(JeelizResizer);\n    console.log(\"about to resize\");\n    JeelizResizer.size_canvas({\n      canvasId: \"jeeFaceFilterCanvas\",\n      callback: this.onInitialResizeReady\n    });\n  }\n\n  onShutter() {\n    // Store current canvas image somewhere, change the view to edit mode\n    const canvas = document.getElementById(\"jeeFaceFilterCanvas\");\n    localStorage.setItem(\"photo\", canvas.toDataURL());\n    console.log(\"Setting photo to local\");\n    //this.setState({ redirect: \"/edit\" });\n    window.location.hash = \"/edit\";\n  }\n\n  onClickFlip() {\n    //faceFilter.update_video\n    alert(\"Flip\");\n\n    //const videoElement = null;\n    //faceFilter.update_videoElement(videoElement, () => {})\n  }\n\n  openProfile() {\n    window.location.hash = \"/profile\";\n  }\n\n  onCarouselChange(index) {\n    console.log(\"Requested effect \" + index);\n\n    // Remove 3D\n    this.faceObject.remove(this.threeCube);\n\n    // Create effects array depending on selected filter\n    let effects;\n    switch (index) {\n      case 0:\n        // Default effect\n        effects = [\n          new HueSaturationEffect({ saturation: -1 }),\n          new BrightnessContrastEffect({ contrast: 0.5 }),\n          new DotScreenEffect({ scale: 2 })\n        ];\n        break;\n      case 1:\n        // Light\n        effects = [\n          new HueSaturationEffect({ saturation: -1 }),\n          new BrightnessContrastEffect({ contrast: 0.0, brightness: 0.75 }),\n          new DotScreenEffect({ scale: 1 })\n        ];\n        break;\n      case 2:\n        effects = [\n          new HueSaturationEffect({ saturation: -1 }),\n          new BrightnessContrastEffect({ contrast: 0.7, brightness: 0.25 }),\n          new DotScreenEffect({ scale: 0.75, dotAngle: 55 })\n        ];\n        break;\n      case 3:\n        effects = [\n          new HueSaturationEffect({ saturation: -1 }),\n          new BrightnessContrastEffect({ contrast: 0.5 }),\n          new DotScreenEffect({ scale: 2 })\n        ];\n        this.faceObject.add(this.threeCube);\n        break;\n      case 4:\n        // Vignette\n        effects = [\n          new HueSaturationEffect({ saturation: -1 }),\n          new BrightnessContrastEffect({ contrast: 0.6, brightness: 0.4 }),\n          new VignetteEffect(),\n          new DotScreenEffect({ scale: 1 })\n        ];\n        break;\n      case 5:\n        // Low Q\n        effects = [\n          new HueSaturationEffect({ saturation: -1 }),\n          new BrightnessContrastEffect({ contrast: 1 }),\n          new PixelationEffect(7)\n        ];\n        break;\n      case 6:\n        // Glitch\n        effects = [\n          new HueSaturationEffect({ saturation: -1 }),\n          new BrightnessContrastEffect({\n            contrast: 0.6,\n            brightness: 0.4\n          }),\n          new GlitchEffect({\n            //duration: new Vector2(20000, 40000),\n            //delay: new Vector2(20000, 40000),\n            glitchMode: GlitchMode.SPORADIC,\n          }),\n          new DotScreenEffect({ scale: 1 })\n        ];\n        break;\n      default:\n        alert(\"Filter not defined!\");\n        break;\n    }\n\n    // Build new EffectPass\n    const pass = new EffectPass(this.camera, ...effects);\n    pass.renderToScreen = true;\n\n    // Replace old pass with new one\n    if (this.effectPass !== null) {\n      this.composer.removePass(this.effectPass);\n    }\n    this.effectPass = pass;\n    this.composer.addPass(this.effectPass);\n  }\n\n  render() {\n    const redirect = this.state.redirect;\n    if (redirect) {\n      return <Redirect to={redirect} />;\n    }\n\n    return (\n      <div className=\"camera-view fill-screen\">\n        <canvas width=\"360\" height=\"640\" id=\"jeeFaceFilterCanvas\" />\n        <button\n          className=\"avatar\"\n          style={{\n            backgroundImage: `url(${this.props.userImageUrl})`,\n            backgroundSize: \"cover\"\n          }}\n          onClick={this.openProfile}\n        />\n        <button className=\"flip\" onClick={this.onClickFlip}>\n          <img src=\"/flip.svg\" alt=\"Flip\" />\n        </button>\n        <button className=\"shutter\" onClick={this.onShutter} />\n\n        <Slider {...this.sliderSettings} className=\"effect-slider\">\n          {this.effects.map((effect, index) => (\n            <EffectThumb key={index} icon={effect.icon} bg={effect.bg} />\n          ))}\n        </Slider>\n        <button className=\"stories\">\n          <img src=\"/stories.svg\" alt=\"Stories\" />\n        </button>\n      </div>\n    );\n  }\n}\n\nclass EffectThumb extends React.Component {\n  render() {\n    return (\n      <div>\n        <div\n          className=\"effect-thumb\"\n          style={{ backgroundImage: `url(${this.props.icon})`, backgroundColor: this.props.bg }}\n        >\n          {this.props.name}\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default Camera;\n","import React from \"react\";\nimport { Redirect } from \"react-router\";\nimport \"./App.css\";\n\nclass Edit extends React.Component {\n  constructor(props) {\n    super(props);\n\n    let redirect = null;\n    const initialData = localStorage.getItem(\"photo\");\n    console.log(initialData);\n    if (!initialData) {\n      alert(\"No image found\");\n      redirect = \"/\";\n    }\n\n    this.state = {\n      redirect: redirect,\n      imageData: initialData\n    };\n\n    this.imageDataLoaded = this.imageDataLoaded.bind(this);\n    this.onClickCancel = this.onClickCancel.bind(this);\n    this.onClickSend = this.onClickSend.bind(this);\n  }\n\n  componentDidMount() {\n    // Load the image in memory first\n    const img = new Image();\n    img.onload = this.imageDataLoaded;\n    img.src = this.state.imageData;\n  }\n\n  imageDataLoaded(e) {\n    const img = e.target;\n    const canvas = this.refs.canvas;\n\n    // Resize canvas\n    canvas.width = img.width;\n    canvas.height = img.height;\n\n    // Draw the image data onto the canvas\n    const ctx = canvas.getContext(\"2d\");\n    ctx.drawImage(img, 0, 0);\n    console.log(\"Image datas have been put!\");\n  }\n\n  onClickCancel() {\n    localStorage.removeItem(\"photo\");\n    this.setState({ redirect: \"/\" });\n  }\n\n  onClickSend() {\n    this.setState({ redirect: \"/send\" });\n  }\n\n  render() {\n    const redirect = this.state.redirect;\n    if (redirect) {\n      return <Redirect to={redirect} />;\n    }\n    return (\n      <div className=\"edit-page fill-screen\">\n        <canvas ref=\"canvas\" width=\"360\" height=\"640\" />\n        <button className=\"cancel\" onClick={this.onClickCancel}>\n          <img src=\"/cancel.svg\" alt=\"Cancel\" />\n        </button>\n        <button className=\"send\" onClick={this.onClickSend}>\n          <img src=\"/send.svg\" alt=\"Send\" />\n        </button>\n        <div className=\"floating-label sendTo\" onClick={this.onClickSend}>\n          Send To\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default Edit;\n","import React from \"react\";\nimport { Redirect } from \"react-router\";\nimport \"./App.css\";\n\nclass Send extends React.Component {\n  constructor(props) {\n    super(props);\n    let redirect = null;\n    this.state = {\n      redirect: redirect,\n      sending: false,\n      loadingText: \"Sending...\"\n    };\n\n    this.onClickCancel = this.onClickCancel.bind(this);\n    this.onSelect = this.onSelect.bind(this);\n    this.updateLoader = this.updateLoader.bind(this);\n  }\n\n  componentDidMount() {}\n\n  onClickCancel() {\n    this.setState({ redirect: \"/edit\" });\n  }\n\n  onSelect() {\n    // TMP: Send fax now\n    /* eslint-disable no-restricted-globals */\n    if (!confirm(\"Send this fax?\")) {\n      return;\n    }\n\n    this.setState({ sending: true });\n\n    // Play awful noise\n    this.audio = new Audio(\"/noise.m4a\");\n    this.audio.onended = () => {\n      this.setState({ sending: false, redirect: \"/\" });\n    };\n    this.audio.play();\n\n    setTimeout(this.updateLoader, 1000);\n    fetch(\"https://stepheneisenhauer.com/misc/sfx.php\", {\n      method: \"post\",\n      body: JSON.stringify({\n        image: localStorage.getItem(\"photo\")\n      })\n    })\n      .then((response) => {\n        console.log(\"Send fax 1\");\n      })\n      .then((data) => {\n        console.log(\"Send fax 2\");\n        this.setState({ sending: false });\n      });\n  }\n\n  updateLoader() {\n    if (this.state.sending) {\n      this.setState({\n        loadingText: {\n          \"Sending...\": \"Sending\",\n          Sending: \"Sending.\",\n          \"Sending.\": \"Sending..\",\n          \"Sending..\": \"Sending...\"\n        }[this.state.loadingText]\n      });\n      setTimeout(this.updateLoader, 1000);\n    }\n  }\n\n  render() {\n    const redirect = this.state.redirect;\n    if (redirect) {\n      return <Redirect to={redirect} />;\n    }\n\n    let sendingElement = null;\n    if (this.state.sending) {\n      sendingElement = (\n        <div className=\"sendingModal\">{this.state.loadingText}</div>\n      );\n    }\n\n    const friends = [\n      {\n        name: \"Milo\",\n        photo: \"https://www.fillmurray.com/g/64/64\",\n        number: \"12345\"\n      },\n      {\n        name: \"Grover\",\n        photo: \"https://www.fillmurray.com/g/72/72\",\n        number: \"12345\"\n      },\n      {\n        name: \"Genie\",\n        photo: \"https://www.fillmurray.com/g/48/48\",\n        number: \"12345\"\n      },\n      {\n        name: \"Opi\",\n        photo: \"https://www.fillmurray.com/g/56/56\",\n        number: \"12345\"\n      },\n      {\n        name: \"Holly\",\n        photo: \"https://www.fillmurray.com/g/84/84\",\n        number: \"12345\"\n      },\n      {\n        name: \"Dougie\",\n        photo: \"https://www.fillmurray.com/g/64/64\",\n        number: \"12345\"\n      }\n    ];\n\n    const friendRows = friends.map((friend, idx) => (\n      <DestinationRow name={friend.name} key={idx} photo={friend.photo} onClick={this.onSelect} />\n    ));\n\n    return (\n      <div className=\"send-page fill-screen\">\n        {sendingElement}\n        <button className=\"cancel\" onClick={this.onClickCancel}>\n          <img src=\"/cancel.svg\" alt=\"Cancel\" />\n        </button>\n        <h2>Friends</h2>\n        <ul>{friendRows}</ul>\n      </div>\n    );\n  }\n}\n\nclass DestinationRow extends React.Component {\n  render() {\n    return (\n      <li onClick={this.props.onClick}>\n        <div className=\"icon\" style={{backgroundImage: `url(${this.props.photo})`}} />\n        <div className=\"label\">{this.props.name}</div>\n        <div className=\"chevron\"></div>\n      </li>\n    );\n  }\n}\n\nexport default Send;\n","import React from \"react\";\nimport \"./App.css\";\n\nclass Login extends React.Component {\n  onSuccess() {}\n\n  componentDidMount() {\n    window.gapi.signin2.render(\"signinButton\", {\n      scope: \"profile email\",\n      width: 240,\n      height: 50,\n      longtitle: true,\n      theme: \"dark\",\n      //onsuccess: onSuccess,\n      //onfailure: onFailure\n    });\n  }\n\n  render() {\n    return (\n      <div className=\"login-page fill-screen\">\n        <h1>Sign in to get started</h1>\n        \n        <div id=\"signinButton\" />\n      </div>\n    );\n  }\n}\n\nexport default Login;\n","import React from \"react\";\nimport { Link } from \"react-router-dom\";\nimport \"./App.css\";\n\nclass Profile extends React.Component {\n  render() {\n    return (\n      <div className=\"profile-page fill-screen\">\n        <Link to=\"/\">\n          <button className=\"cancel\" onClick={this.onClickCancel}>\n            <img src=\"/cancel.svg\" alt=\"Cancel\" />\n          </button>\n        </Link>\n\n        <div style={{ textAlign: \"center\" }}>\n          <img\n            src=\"/icon2-512.png\"\n            style={{ width: \"30vw\", height: \"30vw\" }}\n          />\n          <h3 style={{ fontSize: \"14px\" }}>{this.props.user.name}</h3>\n          <p style={{ fontSize: \"12px\" }}>{this.props.user.email}</p>\n        </div>\n\n        <h3>Other links</h3>\n\n        <RowButton label=\"HelloHunt\" href=\"https://www.hellosign.com/\" />\n        <RowButton label=\"Moar Faxes\" href=\"https://www.hellosign.com/\" />\n        <RowButton\n          label=\"HelloFax\"\n          href=\"https://www.hellosign.com/products/hellofax\"\n        />\n        <RowButton label=\"HelloSign\" href=\"https://www.hellosign.com/\" />\n        <RowButton\n          label=\"HelloWorks\"\n          href=\"https://www.hellosign.com/products/helloworks\"\n        />\n      </div>\n    );\n  }\n}\n\nclass RowButton extends React.Component {\n  render() {\n    return (\n      <a href={this.props.href} target=\"_blank\" className=\"row-button\">\n        <div className=\"label\">{this.props.label}</div>\n      </a>\n    );\n  }\n}\n\nexport default Profile;\n","import React from \"react\";\nimport { HashRouter as Router, Route, Link } from \"react-router-dom\";\nimport Camera from \"./Camera\";\nimport Edit from \"./Edit\";\nimport Send from \"./Send\";\nimport Login from \"./Login\";\nimport Profile from \"./Profile\";\nimport \"slick-carousel/slick/slick.css\";\nimport \"slick-carousel/slick/slick-theme.css\";\nimport \"./App.css\";\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n\n    // Prebind\n    this.initSigninV2 = this.initSigninV2.bind(this);\n    this.onSigninChanged = this.onSigninChanged.bind(this);\n    this.onUserChanged = this.onUserChanged.bind(this);\n\n    this.state = {\n      authState: \"uninitialized\"\n    };\n  }\n\n  componentDidMount() {\n    console.log(\"gapi\", window.gapi);\n\n    // Determine if authenticated\n    window.gapi.load(\"auth2\", this.initSigninV2);\n  }\n\n  initSigninV2() {\n    console.log(\"initted\");\n    const auth2 = window.gapi.auth2.init({\n      client_id:\n        \"410718998162-6okhe5f8m26vn0fhdjeu9gp1edma34uh.apps.googleusercontent.com\",\n      scope: \"profile\"\n    });\n\n    // Listen for sign-in state changes.\n    auth2.isSignedIn.listen(this.onSigninChanged);\n\n    // Listen for changes to current user.\n    auth2.currentUser.listen(this.onUserChanged);\n\n    // Sign in the user if they are currently signed in.\n    if (auth2.isSignedIn.get() === true) {\n      auth2.signIn();\n    }\n\n    // Start with the current live values.\n    //refreshValues();\n  }\n\n  /**\n   * Listener method for sign-out live value.\n   *\n   * @param {boolean} val the updated signed out state.\n   */\n  onSigninChanged(val) {\n    console.log(\"Signin state changed to \", val);\n    //debugger;\n  }\n\n  /**\n   * Listener method for when the user changes.\n   *\n   * @param {GoogleUser} user the updated user.\n   */\n  onUserChanged(user) {\n    console.log(\"user changed\", user);\n\n    if (user.getId() === null) {\n      this.setState({ authState: \"unauthenticated\" });\n      return;\n    }\n\n    const profile = user.getBasicProfile();\n    this.setState({\n      authState: \"authenticated\",\n      user: {\n        name: profile.getName(),\n        email: profile.getEmail(),\n        imageUrl: profile.getImageUrl()\n      },\n      userName: profile.getName(),\n      userImageUrl: profile.getImageUrl()\n    });\n    //debugger;\n  }\n\n  render() {\n    const { authState } = this.state;\n\n    if (authState === \"uninitialized\") {\n      return \"\";\n    }\n\n    if (authState === \"unauthenticated\") {\n      return <Login />;\n    }\n\n    if (authState === \"authenticated\") {\n      return (\n        <div className=\"fill-screen\">\n          <Camera userImageUrl={this.state.userImageUrl} />\n          <Router>\n            <Route exact path=\"/\" />\n            <Route path=\"/edit\" component={Edit} />\n            <Route path=\"/send\" component={Send} />\n            <Route\n              path=\"/profile\"\n              render={props => <Profile {...props} user={this.state.user} />}\n            />\n          </Router>\n        </div>\n      );\n    }\n\n    console.error(\"Auth state is: \", authState);\n    return <div>There was a problem :(</div>;\n  }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.register();\n"],"sourceRoot":""}